machine:
  ghc:
    version: 7.8.3
  environment:
    PATH: $HOME/.cabal/bin:$PATH

checkout:
  post:
    - git submodule sync
    - git submodule update --init
    - ./cabal-user-install.sh codecov-haskell
    - git config --global user.email "john@example.com"
    - git config --global user.name "John Doe"

test:
  override:
    - cabal configure --enable-tests --enable-library-coverage --ghc-options=-Werror && cabal build
    - run-cabal-test spec --show-details=always
    - cabal test doctests
  post:
    - codecov-haskell spec --display-report --print-response --exclude-dir=test
